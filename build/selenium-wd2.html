<script type="text/html" data-template-name="open-web">
	<div class="form-row">
		<label for="node-input-serverURL"><i class="fa fa-globe"></i> <span>Server</span></label>
		<input type="text" id="node-input-serverURL">
	</div>
	<div class="form-row">
		<label for="node-input-name"><i class="fa fa-globe"></i> <span>Name</span></label>
		<input type="text" id="node-input-name">
	</div>
	<div class="form-row">
        <label for="node-input-browser"><i class="fa fa-empire"></i> <span>Browser</span></label>
        <select id="node-input-browser" style="width:125px !important">
            <option value="chrome">Chrome</option>
            <option value="firefox">Firefox</option>
            <option value="safari">Safari</option>
			<option value="opera">Opera</option>
            <option value="edge">Edge</option>
            <option value="ie">IE</option>
        </select>
    </div>
	<div class="form-row">
		<label for="node-input-webURL"><i class="fa fa-empire"></i> <span>Web URL</span></label>
		<input type="text" id="node-input-webURL">
	</div>
	<div class="form-row">
		<label for="node-input-width"><i class="fa fa-empire"></i> <span>Width</span></label>
		<input type="text" id="node-input-width" value="1024">
	</div>
	<div class="form-row">
		<label for="node-input-height"><i class="fa fa-empire"></i> <span>Height</span></label>
		<input type="text" id="node-input-height" value="768">
	</div>
	<div class="form-row">
		<label for="node-input-timeout"><i class="fa fa-empire"></i> <span>Timeout</span></label>
		<input type="text" id="node-input-timeout" value="1000">
	</div>
	<div class="form-row">
		<input type="checkbox" id="node-input-maximized" checked style="display: inline-block; width: auto; vertical-align: top;">
		<label for="node-input-maximized" style="width: auto;">Maximize window</label>
	</div>
	<div class="form-row">
		<input type="checkbox" id="node-input-headless" checked style="display: inline-block; width: auto; vertical-align: top;">
		<label for="node-input-headless" style="width: auto;">Launch Headless</label>
	</div>
</script>

<script type="text/html" data-help-name="open-web">
	<p>Create an instance of selenium webdriver and connect to the Selenium Server when an event is triggered.</p>
	<strong>Inputs:</strong>
	<p><ul>
		<li><a>Server</a>: specify the selenium server configuration. It could be localhost or remote Selenium Server.</li>
	    <li><a>Browser</a>: specify the selenium node which support the web browser you wan tot test such as [Chrome, Firefox etc.,]</li>
		<li><a>Web URL</a>: specify the web page to start browsing the targeted application for your test.</li>
		<li><a>Web Title</a>: specify the expected title to compare if set. Otherwise this node will bypass the sanity check operation.</li>
		<li><a>Timeout</a>: specify the timeout during lookup for the title operation.</li>
	</ul></p>
	<strong>Outputs:</strong>
	<ul>
	<li><u>First output : </u> this ouput is used in case of success of the Selenium action.</li>
	<li><u>Second output : </u> this ouput is used in case of failure of the Selenium action.<li>
	<ul>
	<strong>MSG:</strong>
	<p><code>msg.error</code> When the title is unexpected or cannot find element, this node generates the error with detail information</p>
	<p><code>msg.driver</code> Always pass webdriver object to the next node for ad-hoc function code.</p>
	<p><code>msg.element</code> If the element is found, it will be passed though the msg object to the next node.</p>
	<p><code>msg.payload</code> contains the title of the opened web page. This payload value will be used to compare with the expected Web Title value if that value is set.</p>
</script>

<script type="text/javascript">
	RED.nodes.registerType('open-web', {
		category : 'wd2',
		defaults : {
			name : {
				value : ""
			},
            browser : {
                value : "chrome",
                required : true
            },
			webURL : {
				value : "https://www.google.com/",
				required : true
			},
			width : {
				value : 1280,
				validate : RED.validators.number()
			},
			height : {
				value : 1024,
				validate : RED.validators.number()
			},
			timeout : {
				value : 3000,
				required : true,
				validate : RED.validators.number()
			},
			maximized : {
				value : true,
				required : true
			},
			headless : {
				value : false,
				required : true
			},
			serverURL : {
				type : "selenium-server",
				required : true
			}
		},
		color : "#47B6EE",
		inputs : 1,
		outputs : 1,
		outputLabels: ["success"],
		icon : function() {
			return this.browser + ".svg";
		},
		label : function() {
			return this.name || this.topic || "Open URL";
		},
		labelStyle : function() {
			return this.name ? "node_label_italic" : "";
		}
	}); 
</script>

<script type="text/html" data-template-name="close-web">
	<div class="form-row">
		<label for="node-input-name"><i class="fa fa-globe"></i> <span>Name</span></label>
		<input type="text" id="node-input-name">
	</div>
	<div class="form-row">
		<label for="node-input-waitFor"><i class="fa fa-empire"></i> <span>Wait For</span></label>
		<input type="text" id="node-input-waitFor" value="00">
	</div>
</script>

<script type="text/html" data-help-name="close-web">
	<p>Close the web browser which is openned by the open-web node and finalize the selenium session.</p>
	<strong>Outputs:</strong>
	<ul>
	<li><u>First output : </u> this ouput is used in case of success of exit.</li>
	<li><u>Second output : </u> this ouput is used in case of failure of exit.<li>
	<ul>
	<strong>MSG:</strong>
	<p><code>msg.error</code> In caise of failure, this node generates the error with detailled information</p>
	<p><code>msg.driver</code> should be null in case of success</p>
</script>

<script type="text/javascript">
	RED.nodes.registerType('close-web', {
		category : 'wd2',
		defaults : {
			name : {
				value : ""
			}, 
			waitFor : {
				value : 500,
				validate : RED.validators.number()
			}
		},
		color : "#47B6EE",
		inputs : 1,
		outputs : 2,
		icon : "font-awesome/fa-window-close-o",
		label : function() {
			return this.name || "Close";
		},
		labelStyle : function() {
			return this.name ? "node_label_italic" : "";
		}
	}); 
</script>

<script type="text/html" data-template-name="wd2-server">
	<div class="form-row">
		<ul style="background: #fff; min-width: 600px; margin-bottom: 20px;" id="node-config-wd2-server-tabs"></ul>
	</div>
		<div id="node-config-wd2-server-tabs-content" style="min-height: 170px;">
			<div id="wd2-server-tab-connection" style="display:none">
			<div class="form-row node-input-remoteurl">
				<label for="node-config-input-remoteurl"><i class="fa fa-globe"></i> <span>Remote Url</span></label>
				<input class="input-append-left" type="text" id="node-config-input-remoteurl" placeholder="http://localhost:4444/wd/hub" style="width: 40%;" >
			</div>
		</div>
	</div>
</script>

<script type="text/javascript">
	RED.nodes.registerType('no', {
		category : 'config',
		defaults : {
			remoteurl : {
				value : "http://localhost:4444/wd/hub",
				required : true
			}
		},
		label : function() {
			return (this.remoteurl ? this.remoteurl : "localhost@4444");
		},
		oneditprepare : function() {
			var tabs = RED.tabs.create({
				id : "node-config-wd2-server-tabs",
				onchange : function(tab) {
					$("#node-config-wd2-server-tabs-content").children().hide();
					$("#" + tab.id).show();
				}
			});
			tabs.addTab({
				id : "wd2-server-tab-connection",
				label : "Selenium Server"
			});
			setTimeout(function() {
				tabs.resize();
			}, 0);
		}
	}); 
</script>

<script type="text/html" data-template-name="find-element">
	<div class="form-row">
		<label for="node-input-name"><i class="fa fa-search"></i> <span>Name</span></label>
		<input type="text" id="node-input-name">
	</div>
	<div class="form-row">
		<label for="node-input-selector"><i class="fa fa-empire"></i> <span>By</span></label>
		<select id="node-input-selector" style="width:125px !important">
			<option value=""></option>
			<option value="id">id</option>
			<option value="name">name</option>
			<option value="link">link</option>
			<option value="xpath">xpath</option>
			<option value="tagName">tagName</option>
			<option value="className">className</option>
			<option value="linkText">linkText</option>
			<option value="cssSelector">cssSelector</option>
		</select>
	</div>
	<div class="form-row">
		<label for="node-input-target"><i class="fa fa-empire"></i> <span>Target</span></label>
		<input type="text" id="node-input-target">
	</div>
	<div class="form-row">
		<label for="node-input-timeout"><i class="fa fa-empire"></i> <span>Timeout</span></label>
		<input type="text" id="node-input-timeout" value="1000">
	</div>
	<div class="form-row">
		<label for="node-input-waitFor"><i class="fa fa-empire"></i> <span>Wait For</span></label>
		<input type="text" id="node-input-waitFor" value="00">
	</div>
</script>

<script type="text/html" data-help-name="find-element">
	<p>Find an object or element by using selenium webdriver <code>findElement()</code>.</p>
	<strong>Inputs:</strong>
	<p><ul>
		<li><a>By</a>: specify the way to find an element by selector. The <code>msg.selector</code> will override the <code>By</code> field if set.</li>
		<li><a>Target</a>: specify the selector's value to lookup. The<code>msg.target</code> will override the <code>Target</code> field if set.</li>
		<li><a>Timeout</a>: specify the timeout during lookup operation. The <code>msg.timeout</code> will override the <code>Timeout</code> field if set.</li>
		<li><a>Wait For</a>: specify the time to wait before looking up. The <code>msg.waitFor</code> will override the <code>Wait For</code> field if set.</li>
	</ul></p>
	<strong>Outputs:</strong>
	<p><code>msg.error</code> When the object is unexpected or cannot find element, this node generates the error with detail information</p>
	<p><code>msg.element</code> If the element is found, it will be passed though the msg object to the next node.</p>
</script>

<script type="text/javascript">
	RED.nodes.registerType('find-element', {
		category : 'wd2',
		defaults : {
			name : {
				value : ""
			},
			selector : {
				value : "",
				required : true
			},
			target : {
				value : "",
				required : true
			},
			timeout : {
				value : 3000,
				required : true,
				validate : RED.validators.number()
			}, 
			waitFor : {
				value : 500,
				validate : RED.validators.number()
			}
		},
		color : "#47B6EE",
		inputs : 1,
		outputs : 2,
		icon : "font-awesome/fa-search",
		label : function() {
			return this.name || "Find Element";
		},
		labelStyle : function() {
			return this.name ? "node_label_italic" : "";
		}
	}); 
</script>

<script type="text/html" data-template-name="get-title">
	<div class="form-row">
		<label for="node-input-name"><i class="fa fa-search"></i> <span>Name</span></label>
		<input type="text" id="node-input-name">
	</div>
	<div class="form-row">
		<label for="node-input-webTitle"><i class="fa fa-empire"></i> <span>Web Title</span></label>
		<input type="text" id="node-input-webTitle">
	</div>
	<div class="form-row">
		<label for="node-input-timeout"><i class="fa fa-empire"></i> <span>Timeout</span></label>
		<input type="text" id="node-input-timeout" value="1000">
	</div>
	<div class="form-row">
		<label for="node-input-waitFor"><i class="fa fa-empire"></i> <span>Wait For</span></label>
		<input type="text" id="node-input-waitFor" value="00">
	</div>
</script>

<script type="text/html" data-help-name="get-title">
	<p>Get windows Title by using selenium webdriver <code>getTitle()</code>.</p>
	<strong>Inputs:</strong>
	<p><ul>
		<li><a>Web Title</a>: specify the expected title to compare if set. Otherwise this node will bypass the sanity check operation.</li>The <code> msg.timeout</code> will override the <code>Timeout</code> field if set.</li>
		<li><a>Timeout</a>: specify the timeout during lookup operation. The <code>msg.timeout</code> will override the <code>Timeout</code> field if set.</li>
		<li><a>Wait For</a>: specify the time to wait before looking up. The <code>msg.waitFor</code> will override the <code>Wait For</code> field if set.</li>
	</ul></p>
	<strong>Outputs:</strong>
	<p><code>msg.error</code> When the object is unexpected or cannot find element, this node generates the error with detail information</p>
	<p><code>msg.webTitle</code> The retreived title of the browser's window</p>
</script>

<script type="text/javascript">
	RED.nodes.registerType('get-title', {
		category : 'wd2',
		defaults : {
			name : {
				value : ""
			},
			webTitle : {
				value : "",
				required : true
			},
			timeout : {
				value : 3000,
				required : true,
				validate : RED.validators.number()
			}, 
			waitFor : {
				value : 500,
				validate : RED.validators.number()
			}
		},
		color : "#47B6EE",
		inputs : 1,
		outputs : 2,
		icon : "font-awesome/fa-header",
		label : function() {
			return this.name || "Get Title";
		},
		labelStyle : function() {
			return this.name ? "node_label_italic" : "";
		}
	}); 
</script>

<script type="text/html" data-template-name="click-on">
	<div class="form-row">
		<label for="node-input-name"><i class="fa fa-globe"></i> <span>Name</span></label>
		<input type="text" id="node-input-name">
	</div>
	<div class="form-row">
		<label for="node-input-selector"><i class="fa fa-empire"></i> <span>By</span></label>
		<select id="node-input-selector" style="width:125px !important">
			<option value=""></option>
			<option value="id">id</option>
			<option value="name">name</option>
			<option value="link">link</option>
			<option value="xpath">xpath</option>
			<option value="tagName">tagName</option>
			<option value="className">className</option>
			<option value="linkText">linkText</option>
			<option value="cssSelector">cssSelector</option>
		</select>
	</div>
	<div class="form-row">
		<label for="node-input-target"><i class="fa fa-empire"></i> <span>Target</span></label>
		<input type="text" id="node-input-target">
	</div>
	<div class="form-row">
		<label for="node-input-timeout"><i class="fa fa-empire"></i> <span>Timeout</span></label>
		<input type="text" id="node-input-timeout" value="1000">
	</div>
	<div class="form-row">
		<label for="node-input-waitFor"><i class="fa fa-empire"></i> <span>Wait For</span></label>
		<input type="text" id="node-input-waitFor" value="00">
	</div>
	<div class="form-row">		
		<input type="checkbox" id="node-input-clickOn" style="display: inline-block; width: auto; vertical-align: top;">
		<label for="node-input-clickOn" style="width: 70%"> <span>Require manual approval on click to continue</span></label>
	</div>
</script>

<script type="text/html" data-help-name="click-on">
	<p>Click on the <code>msg.element</code> which is passed by previous node or after waiting for the expected element is located.</p>
	<strong>Inputs:</strong>
	<p><ul>
		<li><a>By</a>: specify the way to find an element by selector. The <code>msg.selector</code> will override the <code>By</code> field if set.</li>
		<li><a>Target</a>: specify the selector's value to lookup. The<code>msg.target</code> will override the <code>Target</code> field if set.</li>
		<li><a>Timeout</a>: specify the timeout during lookup operation. The <code>msg.timeout</code> will override the <code>Timeout</code> field if set.</li>
		<li><a>Wait For</a>: specify the time to wait before looking up. The <code>msg.waitfor</code> will override the <code>Wait For</code> field if set.</li>
		<li><a>Click On</a>: specify to wait until user click action on the node. The <code>msg.clickOn</code> will override the <code>Click On</code> field if set.</li>
	</ul></p>	
	<strong>Outputs:</strong>
	<p><code>msg.error</code> When the object is unexpected or cannot find element, this node generates the error with detail information</p>
	<p><code>msg.element</code> If the element is found, it will be passed though the msg object to the next node.</p>
</script>

<script type="text/javascript">
	RED.nodes.registerType('click-on', {
		category : 'wd2',
		defaults : {
			name : {
				value : ""
			},
			selector : {
				value : ""
			},
			target : {
				value : ""
			},
			timeout : {
				value : 1000,
				validate : RED.validators.number()
			}, 
			waitFor : {
				value : 500,
				validate : RED.validators.number()
			},
			clickOn : {
				value : false
			}
		},
		color : "#47B6EE",
		inputs : 1,
		outputs : 2,
		icon : "font-awesome/fa-mouse-pointer",
		label : function() {
			return this.name || "Click On";
		},
		labelStyle : function() {
			return this.name ? "node_label_italic" : "";
		},
		button: {			
            onclick: function() {
                var node = this;
                $.ajax({
                    url: "onclick/" + this.id,
                    type:"POST",
                    success: function(resp) {
                        RED.notify(node._("inject.success",{ label:label }),"success");
                    },
                    error: function(jqXHR,textStatus,errorThrown) {
                        if (jqXHR.status == 404) {
                            RED.notify(node._("common.notification.error",{message:node._("common.notification.errors.not-deployed")}),"error");
                        } else if (jqXHR.status == 500) {
                            RED.notify(node._("common.notification.error",{message:node._("inject.errors.failed")}),"error");
                        } else if (jqXHR.status == 0) {
                            RED.notify(node._("common.notification.error",{message:node._("common.notification.errors.no-response")}),"error");
                        } else {
                            RED.notify(node._("common.notification.error",{message:node._("common.notification.errors.unexpected",{status:jqXHR.status,message:textStatus})}),"error");
                        }
                    }
                });
            }
        }
	}); 
</script>

<script type="text/html" data-template-name="send-keys">
	<div class="form-row">
		<label for="node-input-name"><i class="fa fa-globe"></i> <span>Name</span></label>
		<input type="text" id="node-input-name">
	</div>
	<div class="form-row">
		<label for="node-input-value"><i class="fa fa-empire"></i> <span>Value</span></label>
		<input type="text" id="node-input-value">
	</div>
	<div class="form-row">
		<label for="node-input-selector"><i class="fa fa-empire"></i> <span>By</span></label>
		<select id="node-input-selector" style="width:125px !important">
			<option value=""></option>
			<option value="id">id</option>
			<option value="name">name</option>
			<option value="link">link</option>
			<option value="xpath">xpath</option>
			<option value="tagName">tagName</option>
			<option value="className">className</option>
			<option value="linkText">linkText</option>
			<option value="cssSelector">cssSelector</option>
		</select>
	</div>
	<div class="form-row">
		<label for="node-input-target"><i class="fa fa-empire"></i> <span>Target</span></label>
		<input type="text" id="node-input-target">
	</div>
	<div class="form-row">
		<label for="node-input-timeout"><i class="fa fa-empire"></i> <span>Timeout</span></label>
		<input type="text" id="node-input-timeout" value="1000">
	</div>
	<div class="form-row">
		<label for="node-input-waitFor"><i class="fa fa-empire"></i> <span>Wait For</span></label>
		<input type="text" id="node-input-waitFor" value="00">
	</div>
	<div class="form-row">		
		<input type="checkbox" id="node-input-clearVal" value="false" style="display: inline-block; width: auto; vertical-align: top;">
		<label for="node-input-clearVal" style="width: 70%"> <span>Clear the element value before sending the keys.</span></label>
	</div>
</script>

<script type="text/html" data-help-name="send-keys">
	<p>Send keyboard keys to the <code>msg.element</code> from previous node or after waiting for the expected element is located.</p>
	<strong>Inputs:</strong>
	<p><ul>
		<li><a>Value</a>: specify the value to get. The <code>msg.value</code> will override the <code>Value</code> field if set.</li>
		<li><a>By</a>: specify the way to find an element by selector. The <code>msg.selector</code> will override the <code>By</code> field if set.</li>
		<li><a>Target</a>: specify the selector's value to lookup. The<code>msg.target</code> will override the <code>Target</code> field if set.</li>
		<li><a>Timeout</a>: specify the timeout during lookup operation. The <code>msg.timeout</code> will override the <code>Timeout</code> field if set.</li>
		<li><a>Wait For</a>: specify the time to wait before looking up. The <code>msg.waitFor</code> will override the <code>Wait For</code> field if set.</li>
		<li><a>Clear Value</a>: clear the element value if checked. The <code>msg.clearVal</code> will override the <code>Clear Value</code> field if set.</li>
	</ul></p>	
	<strong>Outputs:</strong>
	<p><code>msg.error</code> When the object is unexpected or cannot find element, this node generates the error with detail information</p>
	<p><code>msg.element</code> If the element is found, it will be passed though the msg object to the next node.</p>
</script>

<script type="text/javascript">
	RED.nodes.registerType('send-keys', {
		category : 'wd2',
		defaults : {
			name : {
				value : ""
			},
			value : {
				value : ""
			},
			selector : {
				value : ""
			},
			target : {
				value : ""
			},
			timeout : {
				value : 1000,
				validate : RED.validators.number()
			},
			waitFor : {
				value : 500,
				validate : RED.validators.number()
			},
			clearval : {
				value : false
			}
		},
		color : "#47B6EE",
		inputs : 1,
		outputs : 2,
		icon : "font-awesome/fa-font",
		label : function() {
			return this.name || "Send Keys";
		},
		labelStyle : function() {
			return this.name ? "node_label_italic" : "";
		}
	}); 
</script>


<script type="text/html" data-template-name="get-value">
	<div class="form-row">
		<label for="node-input-name"><i class="fa fa-globe"></i> <span>Name</span></label>
		<input type="text" id="node-input-name">
	</div>
	<div class="form-row">
		<label for="node-input-expected"><i class="fa fa-globe"></i> <span>Expected</span></label>
		<input type="text" id="node-input-expected">
	</div>
	<div class="form-row">
		<label for="node-input-selector"><i class="fa fa-empire"></i> <span>By</span></label>
		<select id="node-input-selector" style="width:125px !important">
			<option value="id">id</option>
			<option value="name">name</option>
			<option value="link">link</option>
			<option value="xpath">xpath</option>
			<option value="tagName">tagName</option>
			<option value="className">className</option>
			<option value="linkText">linkText</option>
			<option value="cssSelector">cssSelector</option>
		</select>
	</div>
	<div class="form-row">
		<label for="node-input-target"><i class="fa fa-empire"></i> <span>Target</span></label>
		<input type="text" id="node-input-target">
	</div>
	<div class="form-row">
		<label for="node-input-timeout"><i class="fa fa-empire"></i> <span>Timeout</span></label>
		<input type="text" id="node-input-timeout" value="1000">
	</div>
	<div class="form-row">
		<label for="node-input-waitfor"><i class="fa fa-empire"></i> <span>Wait For</span></label>
		<input type="text" id="node-input-waitFor" value="00">
	</div>	
</script>

<script type="text/html" data-help-name="get-value">
	<p>Get the value from <code>value</code> attribute of the <code>msg.element</code> or after waiting for the expected element is located.</p>
	<strong>Inputs:</strong>
	<p><ul>
		<li><a>Expected</a>: specify the expected value to compare. The <code>msg.expected</code> will override the <code>Expected</code> field if set.</li>
		<li><a>By</a>: specify the way to find an element by selector. The <code>msg.selector</code> will override the <code>By</code> field if set.</li>
		<li><a>Target</a>: specify the selector's value to lookup. The<code>msg.target</code> will override the <code>Target</code> field if set.</li>
		<li><a>Timeout</a>: specify the timeout during lookup operation. The <code>msg.timeout</code> will override the <code>Timeout</code> field if set.</li>
		<li><a>Wait For</a>: specify the time to wait before looking up. The <code>msg.waitFor</code> will override the <code>Wait For</code> field if set.</li>
	</ul></p>	
	<p>If the <code>msg.filename</code> is passed through, the <code>msg.payload</code> will be written into the file path.</p>
	<strong>Outputs:</strong>
	<p><code>msg.error</code> When the object is unexpected or cannot find element, this node generates the error with detail information</p>
	<p><code>msg.element</code> If the element is found, it will be passed though the msg object to the next node.</p>
	<p><code>msg.payload</code> contains the result of the <code>value</code> attribute.</p>
</script>

<script type="text/javascript">
	RED.nodes.registerType('get-value', {
		category : 'wd2',
		defaults : {
			name : {
				value : ""
			},
			expected : {
				value : ""
			},
			selector : {
				value : ""
			},
			target : {
				value : ""
			},
			timeout : {
				value : 1000,
				validate : RED.validators.number()
			},
			waitfor : {
				value : 500,
				validate : RED.validators.number()
			},
			savetofile : {
				value : false
			}
		},
		color : "#47B6EE",
		inputs : 1,
		outputs : 2,
		icon : "font-awesome/fa-file-text-o",
		label : function() {
			return this.name || "Get Value";
		},
		labelStyle : function() {
			return this.name ? "node_label_italic" : "";
		}
	}); 
</script>
